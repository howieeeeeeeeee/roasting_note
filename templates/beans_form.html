{% extends "base.html" %}

{% block title %}{% if is_edit %}Edit{% else %}Add{% endif %} Bean - RoastLogger{% endblock %}

{% block content %}
<div class="page-header">
    <h1>{% if is_edit %}Edit{% else %}Add New{% endif %} Bean</h1>
</div>

<form action="{% if is_edit %}{{ url_for('api_beans_edit', bean_id=bean._id) }}{% else %}{{ url_for('api_beans_add') }}{% endif %}" method="POST" class="form">
    <div class="form-group">
        <label for="name">Bean Name *</label>
        <input type="text" id="name" name="name" required value="{{ bean.name if bean else '' }}" placeholder="e.g., Ethiopia Yirgacheffe Gedeo">
    </div>

    <div class="form-row">
        <div class="form-group">
            <label for="origin">Origin</label>
            <input type="text" id="origin" name="origin" value="{{ bean.origin if bean else '' }}" placeholder="e.g., Ethiopia">
        </div>

        <div class="form-group">
            <label for="process">Process</label>
            <input type="text" id="process" name="process" value="{{ bean.process if bean else '' }}" placeholder="e.g., Washed, Natural, Honey">
        </div>
    </div>

    <div class="form-group">
        <label for="supplier">Supplier</label>
        <input type="text" id="supplier" name="supplier" value="{{ bean.supplier if bean else "Sweet Maria's" }}" placeholder="e.g., Sweet Maria's">
    </div>

    <div class="form-row">
        <div class="form-group">
            <label for="purchase_date">Purchase Date</label>
            <input type="date" id="purchase_date" name="purchase_date" value="{{ bean.purchase_date.strftime('%Y-%m-%d') if bean and bean.purchase_date else '' }}">
        </div>

        <div class="form-group">
            <label for="purchase_weight_grams">Purchase Weight (grams)</label>
            <input type="number" id="purchase_weight_grams" name="purchase_weight_grams" value="{{ bean.purchase_weight_grams if bean else '' }}" min="0">
        </div>
    </div>

    <div class="form-row">
        <div class="form-group">
            <label for="purchase_price_total">Total Purchase Price</label>
            <input type="number" step="0.01" id="purchase_price_total" name="purchase_price_total" value="{{ bean.purchase_price_total.to_decimal() if bean and bean.purchase_price_total else '' }}" min="0">
        </div>

        <div class="form-group">
            <label for="stock_grams">Current Stock (grams)</label>
            <input type="number" id="stock_grams" name="stock_grams" value="{{ bean.stock_grams if bean else '' }}" min="0">
        </div>
    </div>

    <div class="form-group">
        <label for="notes">Notes</label>
        <textarea id="notes" name="notes" rows="4" placeholder="Tasting notes, website description, etc.">{{ bean.notes if bean else '' }}</textarea>
    </div>

    <div class="form-group">
        <label for="color">Label Color</label>
        <div class="color-picker-wrapper">
            <input type="color" id="color" name="color" value="{{ bean.color if bean and bean.color else '#6B8E6F' }}" class="color-picker-input">
            <span class="color-preview" id="colorPreview">{{ bean.color if bean and bean.color else '#6B8E6F' }}</span>
        </div>
        <p class="helper-text">Choose a color to visually identify this bean on the roast list</p>
    </div>

    <div class="form-actions">
        <button type="submit" class="btn btn-primary">{% if is_edit %}Update{% else %}Add{% endif %} Bean</button>
        <a href="{{ url_for('beans_list') }}" class="btn btn-secondary">Cancel</a>
    </div>
</form>

<script>
    // Update color preview when color changes
    const colorInput = document.getElementById('color');
    const colorPreview = document.getElementById('colorPreview');

    colorInput.addEventListener('input', function() {
        colorPreview.textContent = this.value.toUpperCase();
    });
</script>
{% endblock %}
